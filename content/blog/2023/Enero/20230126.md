---
title: "C√≥mo probar nuestras aplicaciones CAP con token reales en local üò≤ü´£"
date: "2023-01-26T13:19:00.000Z"
description: "Hac√≠a bastante tiempo que no escrib√≠a nada, pero aqu√≠ ten√©is una nueva entrada en el blog que creo que a m√°s de uno les ahorrar√° un quebradero de cabeza y que adem√°s he aprendido hace relativamente poco, si te interesa saber m√°s haz click"
tags: "XSUAA;SAP AUTHORIZATION & AUTHENTICATION"
---
Buenas!!

Hac√≠a bastante tiempo que no escrib√≠a nada, pero aqu√≠ ten√©is una nueva entrada en el blog que creo que a m√°s de uno les ahorrar√° un quebradero de cabeza y que adem√°s he aprendido hace relativamente poco.

¬øA vosotros os pasa que hab√©is intentado probar en local las autorizaciones de CAP pero nunca os funciona del todo bien y ten√©is que estar probando con la aplicaci√≥n desplegada? Porque a mi me pasa y mucho, igual es por vagueza de tener que estar mockeando usuarios e implementando el approuter.

Hace poco me han ense√±ado a c√≥mo hacer una prueba de token manualmente con el xsuaa y he aplicado esto a mis proyectos en local (pens√©, si funciona aqu√≠ tiene que funcionar all√≠ y voil√°), aqu√≠ os dejo el detalle de c√≥mo hacerlo ü•∏

* Primero que todo deb√©is tener una instancia xsuaa en vuestro espacio, de aqu√≠ ten√©is que montar la siguiente url en vuestro browser: {{XSUAAURL}}/oauth/authorize?response_type=code&client_id={{XSUAAClientID}} y ejecutarlo, esto os devolver√° una url con un m√°s o menos tal que as√≠ c√≥digo tal que as√≠ localhost:8080/?code={{AuthorisationCode}}
* Ahora toca irse a postman y hacer una operaci√≥n GET montando esta url {{XSUAAURL}}/oauth/token?grant_type=authorization_code&code={{AuthorisationCode}}
    * En la pesta√±a authorization seleccionamos Basic Auth y en Username = xsuaa client_id y en password xsuaa client_secret
* Esto nos devolver√° un access token v√°lido del xsuaa que tenemos en BTP, si vamos a la p√°gina jwt.io y pegamos el valor de access_token podremos ver todos los roles y atributos que tiene nuestro usuario asignado.
* Usando postman para llamar a la url de nuestro servicio en local (localhost:4004/SERVICIO por ejemplo) y a√±adiendo en la pesta√±a Authorization el tipo bearer, pegamos el access_token y listo.
Reacuerda que para que funcione tienes que tener bindeado el xsuaa a tu servicio en local, puedes hacerlo ejecutando el comando cds bind ‚Äìto {{xsuainstance}}:{{servicekey}}

 

Cualquier cosa no dud√©is en preguntar!!üöÄ